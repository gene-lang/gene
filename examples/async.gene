#!/usr/bin/env gene run

(fn f [a]
  (var future
    (gene/sleep_async 2500)
  )
  (future .on_success (fn []
    (println a)
  ))
  future
)

(f "ASYNC")

(gene/sleep 1000)
(println 1)
(repeat 100 nil)

(gene/sleep 1000)
(println 2)
(repeat 100 nil)

(gene/sleep 1000)
(println 3)

#< Output should look like below (futures are checked at least once every N evaluations)
1
2
ASYNC
3
#>#
